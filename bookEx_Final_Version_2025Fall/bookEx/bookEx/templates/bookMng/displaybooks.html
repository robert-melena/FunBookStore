{% extends "base.html" %}
{% load static %}

{% block content %}
<div class="d-flex justify-content-center mt-4">
  <div class="card shadow-sm" style="width: 900px;">
    <div class="card-header bg-light">
      <h4 class="m-0 fw-semibold">Available Books</h4>
    </div>

    <ul class="list-group list-group-flush">
      {% for bk in books %}
        <small class="text-danger">{{ bk.pic_path }}</small>
      <li class="list-group-item">
        <div class="d-flex gap-3 align-items-start">

          <!-- Book Cover -->
          {% if bk.picture %}
            <img src="{{ bk.picture.url }}" class="rounded border" style="width:90px;height:130px;object-fit:cover;">
            {% else %}
            <img src="{% static 'img/placeholder_book.png' %}" class="rounded border" style="width:90px;height:130px;object-fit:cover;">
            {% endif %}



          <!-- Book Info -->
          <div class="flex-grow-1">
            <h5 class="mb-1">
              <a href="{% url 'bookMng:book_detail' bk.id %}" class="text-decoration-none fw-semibold">
                {{ bk.name }}
              </a>
            </h5>

            <div class="text-muted small mb-2">
              Release: {{ bk.publishdate|date:"M j, Y" }}
              &nbsp;â€¢&nbsp;
              Price: ${{ bk.price|floatformat:2 }}
            </div>

            {% if bk.web %}
              <a href="{{ bk.web }}" target="_blank" class="small text-primary">Book Link</a>
            {% endif %}
          </div>

          <!-- Right Action Button -->
          <div class="ms-auto">
            {% if bk.id in owned_book_ids %}
              <span class="badge bg-success px-3 py-2">Owned</span>
            {% else %}
              <form method="post" action="{% url 'bookMng:cart_add' bk.id %}">
                {% csrf_token %}
                <input type="hidden" name="quantity" value="1">
                <button class="btn btn-sm btn-primary">Add to Cart</button>
              </form>
            {% endif %}
          </div>

        </div>
      </li>
      {% empty %}
      <li class="list-group-item text-center text-muted">No books available.</li>
      {% endfor %}
    </ul>
  </div>
</div>

<div class="text-center mt-3">
  <a href="{% url 'bookMng:cart_detail' %}" class="btn btn-outline-primary">View Cart</a>
</div>
{% endblock %}
